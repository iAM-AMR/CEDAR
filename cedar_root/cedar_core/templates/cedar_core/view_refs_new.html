

<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta http-equiv="x-ua-compatible" content="ie=edge">

    {% load static %}

    <title>References</title>

    <!-- MDB icon -->
    <link rel="icon" href="{% static 'img/mdb-favicon.ico' %}" type="image/x-icon">
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.11.2/css/all.css">
    <!-- Google Fonts Roboto -->
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700&display=swap">
    <!-- Bootstrap core CSS -->
    <link rel="stylesheet" href="{% static 'css/bootstrap.min.css' %}">
    <!-- Material Design Bootstrap -->
    <link rel="stylesheet" href="{% static 'css/mdb.min.css' %}">
    <!-- Your custom styles (optional) - add style.css here -->
    <link rel="stylesheet" href="{% static 'cedar_core/style.css' %}"> 
    <link rel="stylesheet" href="{% static 'cedar_core/bootstrap_table_sort.css' %}">
    <!-- MDBootstrap Datatables  -->
    <link href="{% static 'css/addons/datatables.min.css' %}" rel="stylesheet">
  </head>
  <body>

    <h1>Welcome to CEDAR!</h1>

    <br>
    <br>

    <div class="container-lg">

      <!-- COMMENTED OUT: section for checkboxes -->
      <!-- <div class="row justify-content-center">
        <div class="col-6">
          <h2>Host</h2>
          <form id="hostform" class="form-inline" role="form" action="{% url 'view_references' %}" method="post">
            {% csrf_token %}
            <input type="checkbox" class="form-control" name="chi" value="chicken" onchange="triggerPost()">
            <label for="chicken">Chicken</label>
            <br>
            <input type="checkbox" class="form-control" name="cat" value="cattle" onchange="triggerPost()">
            <label for="cattle">Cattle</label>
            <br>
            <input type="checkbox" class="form-control" name="swi" value="swine" onchange="triggerPost()">
            <label for="swine">Swine</label>
            <br>
            <input type="checkbox" class="form-control" name="tur" value="turkey" onchange="triggerPost()">
            <label for="turkey">Turkey</label>
          </form>

        </div>

        <div class="col-6">
          <h2>Microbe</h2>
        
          <input type="checkbox" id="campy">
          <label for="campy">Campylobacter</label>

          <br>
          <input type="checkbox" id="ent">
          <label for="ent">Enterococcus</label>
          
          <br>
          <input type="checkbox" id="esch">
          <label for="esch">Escherichia (coli)</label>
          <br>
          <input type="checkbox" id="salm">
          <label for="salm">Salmonella</label>

        </div>
      </div> -->

      <br>
      
      <!-- table of references -->
      <table id="myTable" class="table table-bordered table-sm" cellspacing="0" width="100%">
        <thead>
          <tr>
            <th>RWID</th>
            <th>Bibtex Key</th>
            <th>Title</th>
          </tr>
        </thead>
        <tbody>
          {% for reference in refs_list %}
            <tr>
              <td>{{ reference.refwk }}</td>
              <td>{{ reference.key_bibtex }}</td>
              <td>
                <a href="/cedar_core/references/{{ reference.id }}/">{{ reference.study_title }}</a>
              </td>
            </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>

    <style>
      table a:hover { /*code works here but not in css file*/
        color: blue;
        text-decoration: underline;
      }
    </style>

    <!-- SCRIPTS -->
    <!-- jQuery -->
    <script type="text/javascript" src="{% static 'js/jquery.min.js' %}"></script>
    <!-- Bootstrap tooltips -->
    <script type="text/javascript" src="{% static 'js/popper.min.js' %}"></script>
    <!-- Bootstrap core JavaScript -->
    <script type="text/javascript" src="{% static 'js/bootstrap.min.js' %}"></script>
    <!-- MDB core JavaScript -->
    <script type="text/javascript" src="{% static 'js/mdb.min.js' %}"></script>
    <!-- MDBootstrap Datatables  -->
    <script type="text/javascript" src="{% static 'js/addons/datatables.min.js' %}"></script> 
    <!-- Your custom scripts (optional) -->
    <script type="text/javascript"></script>

    <!-- Table scrolling -->
    <script>
      $(document).ready(function () {
        $('#myTable').DataTable({
          "scrollY": "200px",
          "scrollCollapse": true,
        });
        $('.dataTables_length').addClass('bs-select');
      });
    </script>

    <!-- UNCOMMENT: Submit checkbox states as POST without reloading page -->
    <!-- <script>
      function triggerPost() {
        var csrftoken = jQuery("[name=csrfmiddlewaretoken]").val();

        function csrfSafeMethod(method) {
          // these HTTP methods do not require CSRF protection
          return (/^(GET|HEAD|OPTIONS|TRACE)$/.test(method));
        }

        $.ajaxSetup({
            beforeSend: function (xhr, settings) {
                // if not safe, set csrftoken
                if (!csrfSafeMethod(settings.type) && !this.crossDomain) {
                    xhr.setRequestHeader("X-CSRFToken", csrftoken);
                }
            }
        });

        //var formData = $('#hostform').serialize();

        // include unchecked checkboxes. use filter to only include unchecked boxes.
        //$.each($('form input[type=checkbox]')
          //.filter(function(idx){
            //return $(this).prop('checked') === false
          //}),
          //function(idx, el){
            // attach matched element names to the formData with a chosen value.
            ///var emptyVal = "";
            //formData += '&' + $(el).attr('name') + '=' + emptyVal;
          //}
        //);

        $.ajax({
            type: "POST",
            url: $('#hostform').attr('action'),
            data: {'getdata': $('#hostform').serialize()}
        });
      };
    </script> -->

    <!-- Submit (trigger a POST) on the change of a checkbox -->
    <!-- <script>

      //Get a list of which checkboxes are currently checked or not
      var checkboxValues = JSON.parse(localStorage.getItem('checkboxValues')) || {};
      var $checkboxes = $("#checkbox-container :checkbox");

      $checkboxes.on("change", function(){

        // Update checkboxValues based on any changes the user makes
        $checkboxes.each(function(){
          checkboxValues[this.id] = this.checked;
        });

        // Put the checkbox values into local storage so that values won't change when post is triggered
        localStorage.setItem("checkboxValues", JSON.stringify(checkboxValues));

        // On page load (triggered by submit), iterate over checkboxValues and set the value of the boxes
        $('#hostform').on("submit", function() {
          $.each(checkboxValues, function(key, value) {
            $("#" + key).prop('checked', value);
          });
        });

      });

      //$(function() {
        //$("#chicken")
          //.prop('checked', localStorage.input == 'true')
          //.on('change', function() {
            //$('#hostform').submit();
          //});
      //});

      //$(function(){
        //$('#id_days').change(function(){
          //$('#hostform').submit();
        //});
      //});
    </script> -->
    <!-- <script>
      //var checkboxValues = JSON.parse(localStorage.getItem('checkboxValues')) || {};
      
      //************
      var $checkboxes = $(":checkbox");

      $checkboxes.each(function() {
        $(this)
          .prop('checked', localStorage.input == 'true')
          .on("change", function() {
            localStorage.input = this.checked;
            $('#hostform').submit()
          })
      });
      //************

        //.prop('checked', localStorage.input == 'true')
        //.on("change", function() {

          // Store current state of each checkbox
          //$checkboxes.each(function(){
            //checkboxValues[this.id] = this.checked;
            //localStorage.input = this.checked;
            //this.prop('checked', localStorage.input == 'true')
          //});
        
          // Set localStorage to current state of each checkbox
          //localStorage.setItem("checkboxValues", JSON.stringify(checkboxValues));

        
          //localStorage.input = this.checked;

          //$checkboxes.each(function(){
            //checkboxValues[this.id] = this.checked;
          //});

          //$.each(checkboxValues, function(key, value) {
            //$("#" + key).prop('checked', value);
          //});
      //});
    </script> -->

    <!-- <script>
      $(document).ready(function () {
        $checkboxes = $(":checkbox");
        $checkboxes.prop('checked', localStorage.input == 'true');
      });
    </script> -->

    <!-- <script>
      function triggerPost(idnum) {
        //console.log('HERE')
        
          //.on("change", function() {
        //localStorage.input = $("#"+idnum).checked;
        
        $('#hostform').on("submit", function () {
          localStorage.input = $("#"+idnum).checked;
        });
        $('#hostform').submit()
      };
    </script> -->

    <!-- <script>
      function myFunction() {
        // Declare variables
        var input, filter, table, tr, td, i, txtValue, searchField;
        input = document.getElementById("myInput");
        filter = input.value.toUpperCase();
        table = document.getElementById("myTable");
        tr = table.getElementsByTagName("tr");
        searchField = document.getElementById("field").value;
  
        // Loop through all table rows, and hide those who don't match the search query
        for (i = 0; i < tr.length; i++) {
          td = tr[i].getElementsByTagName("td")[searchField];
          if (td) {
            txtValue = td.textContent || td.innerText;
            if (txtValue.toUpperCase().indexOf(filter) > -1) {
              tr[i].style.display = "";
            } else {
              tr[i].style.display = "none";
            }
          }
        }
      }
    </script>

    <script>
      function limitRefs(limited_refs_list) {
        // Declare variables
        var input, filter, table, tr, td, i, txtValue, searchField;
        //var my_test = {{ refs_host_list }};
        //input = document.getElementById(boxType).checked;
        //filter = input.value.toUpperCase();
        table = document.getElementById("myTable");
        tr = table.getElementsByTagName("tr");
        //searchField = document.getElementById("field").value;

        console.log(limited_refs_list);
    
        // Loop through all table rows, and hide those whose RWIDs don't match
        //for (i = 0; i < tr.length; i++) {
          //td = tr[i].getElementsByTagName("td")[0]; //RWID field
          //if (td) {
            //txtValue = td.textContent || td.innerText;
            //if () { //if current RWID is in list of RWIDs
              //tr[i].style.display = "";
            //} else {
              //tr[i].style.display = "none";
            //}
          //}
        //}
      }
    </script> -->

  </body>
</html>